# Machine Learning

**파이프라인 인터페이스**

- 파이프라인은 전처리, 분류 이외에 다른 <u>추정기도</u> 사용할 수 있다.
- 파이프라인의 추정기는 마지막을 제외하고 모두 `transform`이 있어야.  마지막 단계는 적어도 `fit` 메서드는 있어야 한다.
  - 마지막 단계가 `predict`를 가질 필요는 없으므로 스케일 변환이나 PCA만 포함하는 파이프라인을 만들 수 있다.

<br>

**make_pipeline을 사용한 파이프라인 생성**

- 파이프라인 생성이나 이름 짓기 귀찮다면 그냥 `make_pipeline` 활용.
  - 자동으로 파이썬 클래스 이름의 소문자 버전이 이름.
  - 같은 클래스가 한 개 이상있다면 이름 뒤에 숫자.
- `pipe` 객체의 `steps` 속성에 각 단계의 이름이 있다.
- <u>의미 있는 이름을 원한다면 `Pipeline` 메서드로 생성해야.</u>

<Br>

**단계 속성에 접근하기**

- 선형 모델의 계수나 PCA로 추출한 주성분이나 단계에 접근해야 할 일이 있음. 그럴 땐 `named_steps` 속성으로 접근.

<br>

**그리드서치 안 속성에 접근하기**

- 파이프라인을 사용하는 주된 이유는 그리드서치. <u>그리드서치 안 파이프라인 단계에 접근할 때가 많다.</u>
- 최적 모델을 찾은 후 훈련 데이터로 학습한 모델이 `grid.best_estimator_`.
  - `named_steps`로 객체의 단계에 접근.
- <u>표현식이 길긴 하지만 모델 이해에는 도움이 된다.</u>

<br>

**전처리와 모델 매개변수를 위한 그리드서치**

- <u>파이프라인을 사용하면 모든 처리 단계를 하나의 추정기로 캡슐화 가능.</u>
- <u>전처리 매개변수 그리드를 통해 최적의 모델 출력을 이끌어 낼 수 있다.</u>
  - `param_grid`에 전처리 매개변수 적어두기.
- 모델의 매개변수와 함게 전처리 과정의 매개변수를 찾는 것은 매우 강력한 전략.
  - 단점은 그리드에 매개변수가 추가되면 모델의 조합이 늘어난다.

<br>

**모델 선택을 위한 그리드서치**

- 기존엔 선택된 클래스의 매개변수 조합을 찾았다면, 아예 클래스를 찾는데 그리드서치를 사용할 수 있음.
  - 단점은 매개변수 조합이 늘어나면 소요 시간도 증가한다는 것.
- 특정 클래스에 단계를 사용하지 않는다면 `None`.