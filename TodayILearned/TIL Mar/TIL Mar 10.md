# Machine Learning

**교차 검증을 사용한 그리드 서치**

- 데이터를 훈련, 검증, 테스트 세트로 나누는 건 자주 사용되지만, 데이터 나누는 방법에 민감하다.
- 훈련, 검증 세트는 한 번만 나누지 않고 `cross_val_score()` 로 교차 검증해 매개변수를 찾아야 한다.
- scikit-learn에서는 추정기 형태의 `GridSearchCV()`가 구현되어 있다. <u>필요한 건 추정기, 매개변수 그리드, 교차 검증 방법</u>.
- `GridSearchCV()`에는 `predict()`, `score()` 메서드가 구현되어 있다.
- `GridSearchCV().best_score_` 와 `score()` 메서드는 조금 다른데,
  - `best_score_` 는 훈련 모델 내 교차 검증을 진행한 점수,
  - `score()`는 훈련시킨 모델을 테스트 세트로 평가한 점수.

<br>

**교차 검증 결과 분석**

- `GridSearchCV()`의 `cv_results_`를 사용하면 그리드 서치 결과를 쉽게 알아볼 수 있다.
  - 보통 `pd.DataFrame()`을 사용해 데이터프레임으로 전환해 사용한다.

- 만약 SVM()처럼 주요 매개변수가 두 개 있다면 (`C`, `gamma`) heatmap으로 시각화해도 될듯 하다.

<br>

**비대칭 매개변수 그리드 서치**

- 모든 매개변수 조합을 사용하는 것은 불필요할 수도 있다.

- SVM()에는 `kernel`이라는 매개변수가 존재하는데,
  - `kernel=linear`면 매개변수 `C`만 사용하고,
  - `kernel=rbf`면 매개변수 `C`와 `gamma` 둘 다 사용한다.

<br>

**그리드 서치의 다양한 교차 검증 방법**

- cv의 default 매개변수는 분류일 땐 계층별 k-겹 교차 검증, 회귀일 땐 k-겹 교차 검증.
- cv에 다른 교차 검증 방법을 사용할 수 있다. 예를 들어 `ShuffleSplit()`.

<br>

**중첩 교차 검증**

- `GridSearchCV()`로 훈련 세트에 교차 검증을 진행하긴 하지만, 훈련 세트가 잘못 할당되어 있다면 말짱 도루묵.
- 아예 훈련, 테스트 세트 나누는 것도 교차 검증해서 위험 원천 차단할 수 있다.

- `cross_val_score()`내 추정기에 `GridSearchCV()`를 넣기.
  - 어차피 `GridSearchCV()`도 메타 추정기이므로 ok.
- 하지만 이 방법은 모델 생성에 쓰이는게 아니라 그저 매개변수의 일반화 성능을 평가하는데 쓰임.
  - 매개변수 설정이 아닌 테스트 세트 점수 목록을 출력.

<br>

**교차 검증과 그리드 서치 병렬화**

- <u>병렬화하기 쉬움. 단지, 모델에서 병렬화 쓴다면 그리드 서치에선 병렬화 불가.</u>

<br>

**모델 평가 지표**

- 분류는 정확도, 회귀는 $R^2$가 기본.
- 하지만 실제 애플리케이션에서는 안 맞는 경우도 있으니 올바른 지표 선택하는게 중요.

<Br>

**최종 목표를 기억하라**

- 정확도가 우선인지, 의사 결정이 우선인지 생각해야.
- <u>평가 지표를 선택하기 전에</u> 비즈니스 지표같은 고차원적인 목표를 생각해봐야.
- ML 알고리즘을 선택해 나타난 결과를 비즈니스 임팩트라고 한다.
- <u>비즈니스 지표에 긍정적인 영향을 주는 모델 선택, 매개변수 조정을 해야하는데,</u> 실제 적용하지 않고서야 찾기 어렵다.
  - 그렇다고 실제 적용하기는 어려우니 평가 지표를 사용한다.

<br>

**이진 분류 평가 지표**

- 이진 분류는 널리 사용되고 쉬운 모델. 하지만 평가할 때 유의해야 한다.

<br>

**에러의 종류**

- 잘못 분류한 샘플의 수가 정보의 전부는 아니므로, 정확도로는 정보가 부족할 때가 있다.
- 질병의 유무를 판단할 때 질병이 있다면 양성, 없다면 음성이라 한다.
  - 질병이 없는데 있다고 하는 것을 거짓 양성. 통계에서는 Type I error라고 한다.
  - 질병이 있는데 없다고 하는 것을 거짓 음성. 통계에서는 Type II error라고 한다.
- 의학에서는 거짓 양성은 별로 중요치 않다. 상업에서는 이런 에러들을 비용으로 환산해 매기기도 한다.

<br>

**불균형 데이터셋**

- 위 두 종류의 에러는 두 클래스 중 하나가 훨씬 많을 때 중요하다.
- 데이터셋이 한 쪽으로 치우쳐있을 때 불균형 데이터셋이라고 한다.
- 불균형 데이터셋을 사용하면 모델이 진짜 좋은건지 아니면 단지 비율 때문에 그런건지 알 수 없다.

<br>

**오차 행렬**

- 이진 분류 평가 결과를 나타낼 때 널리 사용되는 방법.

| **TN** | **FP** |
| ------ | ------ |
| **FN** | **TP** |

